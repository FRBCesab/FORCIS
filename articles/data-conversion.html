<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="forcis">
<title>Data conversion • forcis</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Data conversion">
<meta property="og:description" content="forcis">
<meta property="og:image" content="https://frbcesab.github.io/forcis/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">forcis</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/forcis.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/data-conversion.html">Data conversion</a>
    <a class="dropdown-item" href="../articles/data-visualization.html">Data visualization</a>
    <a class="dropdown-item" href="../articles/database-versions.html">Database versions</a>
    <a class="dropdown-item" href="../articles/sampling-devices.html">Sampling devices</a>
    <a class="dropdown-item" href="../articles/select-and-filter-data.html">Select and filter data</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/FRBCesab/forcis/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Data conversion</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/FRBCesab/forcis/blob/HEAD/vignettes/data-conversion.Rmd" class="external-link"><code>vignettes/data-conversion.Rmd</code></a></small>
      <div class="d-none name"><code>data-conversion.Rmd</code></div>
    </div>

    
    
<!-- > **NOTE:** THIS IS A WORK IN PROGRESS. -->
<p>The package <code>forcis</code> provides <a href="https://frbcesab.github.io/forcis/reference/index.html#standardization-functions">functions</a>
to homogenize FORCIS data and compute abundances, concentrations, and
frequencies of foraminifera counts. This vignette shows how to use these
functions.</p>
<div class="section level2">
<h2 id="count-formats-within-forcis">Count formats within FORCIS<a class="anchor" aria-label="anchor" href="#count-formats-within-forcis"></a>
</h2>
<p>The FORCIS database includes counts of foraminifera species collected
with multiple devices. These counts are reported in different
formats:</p>
<ul>
<li>Raw abundance: number of specimens counted within a sampling
unit.</li>
<li>Number concentration: number of specimens per cubic meter.</li>
<li>Relative abundance: percentage of specimens relative to the total
counted</li>
<li>Fluxes: number of specimens per square meter per day.</li>
<li>Binned counts: Number of specimens categorized into a specific range
(minimum and maximum) within a sampling unit.</li>
</ul>
</div>
<div class="section level2">
<h2 id="conversion-functions">Conversion Functions<a class="anchor" aria-label="anchor" href="#conversion-functions"></a>
</h2>
<p>The functions detailed in this vignette allow to convert counts
between the following formats <strong>Raw abundance</strong>,
<strong>Relative abundance</strong> and <strong>Number
concentration</strong>.</p>
<blockquote>
<p><strong>NOTE:</strong> FORCIS data from <em>Sediment traps</em> and
the <em>CPR North</em> are not supported by these functions.</p>
</blockquote>
<div class="section level3">
<h3 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h3>
<p>The vignette will use the PUMP data of the FORCIS database. Let’s
import the latest release of the data as described in the <a href="https://frbcesab.github.io/forcis/articles/forcis.html">Get
started vignette</a>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Import pump data </span></span>
<span> <span class="va">pump_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_data.html">read_pump_data</a></span><span class="op">(</span>path <span class="op">=</span> <span class="st">"data"</span><span class="op">)</span></span></code></pre></div>
<p>After obtaining the data, the initial step involves choosing the
taxonomic level for our analyses, (the different taxonomic levels are
described in the <a href="https://www.nature.com/articles/s41597-023-02264-2" class="external-link">original
FORCIS database paper</a> ). This selection is made using the
<code><a href="../reference/select_taxonomy.html">select_taxonomy()</a></code> function.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Select taxonomy</span></span>
<span><span class="va">OT_pump_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/select_taxonomy.html">select_taxonomy</a></span><span class="op">(</span><span class="va">pump_data</span>,<span class="st">'OT'</span><span class="op">)</span></span></code></pre></div>
<p>Once the data contains counts from the same taxonomic level for all
the samples we can proceed with the conversion functions.</p>
<div class="section level4">
<h4 id="compute_abundances">
<code>compute_abundances()</code><a class="anchor" aria-label="anchor" href="#compute_abundances"></a>
</h4>
<p>This function converts all counts into raw abundances, using sampling
metadata such as sample volume and total assemblage counts. It
calculates the raw abundance for each species whose counts are reported
as either relative abundance or number concentrations.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Convert species counts in raw abundance</span></span>
<span><span class="va">OT_pump_data_raw_ab</span><span class="op">=</span><span class="fu"><a href="../reference/computations.html">compute_abundances</a></span><span class="op">(</span><span class="va">OT_pump_data</span>,aggregate <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="compute_concentrations">
<code>compute_concentrations()</code><a class="anchor" aria-label="anchor" href="#compute_concentrations"></a>
</h4>
<p>This function transforms all counts into number concentration
abundances. It also leverages sampling metadata such as sample volume
and total assemblage counts to compute the number concentration for each
species.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Convert species counts in number concentration</span></span>
<span><span class="va">OT_pump_data_n_conc</span><span class="op">=</span><span class="fu"><a href="../reference/computations.html">compute_concentrations</a></span><span class="op">(</span><span class="va">OT_pump_data</span>,aggregate <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="compute_frequencies">
<code>compute_frequencies()</code><a class="anchor" aria-label="anchor" href="#compute_frequencies"></a>
</h4>
<p>This function computes relative abundance for each species using
total assemblage counts when available.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Convert species counts in relative abundance </span></span>
<span><span class="va">OT_pump_data_rel_ab</span><span class="op">=</span><span class="fu"><a href="../reference/computations.html">compute_frequencies</a></span><span class="op">(</span><span class="va">OT_pump_data</span>,aggregate <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>The functions accept two arguments: the input data and the aggregate
argument. If <code>aggregate</code> is set to <strong>TRUE</strong>, the
function will return the transformed counts of each species using the
sample as the unit. If <strong>FALSE</strong>, it will re-calculate the
species’ abundance by subsample.</p>
<p>The functions output a table (long-format) as well as a message
reporting the amount of data that could not be converted because of
missing metadata.</p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Nicolas Casajus, Mattia Greco, Xavier Giraud, Sonia Chaabane.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
